(()=>{var e={705:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(i)for(var s=0;s<this.length;s++){var a=this[s][0];null!=a&&(r[a]=!0)}for(var o=0;o<e.length;o++){var c=[].concat(e[o]);i&&r[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},830:()=>{function e(e,t,n){const i=function(e){const t=document.createElement("span");return t.style.whiteSpace="nowrap",t.className="temp",t.innerHTML=e,t}(`${e?"&nbsp;":""}${t}`);n.appendChild(i);const r=i.getBoundingClientRect().width;return n.removeChild(i),r}function t(e){return void 0!==e.dataset.thellipsisOriginalText}function n(n,i,r){const s=function(e){return t(e)?e.dataset.thellipsisOriginalText:e.innerText}(n),a=function(t,n,i,r){const s=t.split(" ");let a=[],o=0,c="";return s.forEach((function(t,l){var d;a.length>i?a[a.length-1]+=` ${t}`:(o+=e(0!=o,t,n),d={line_width:o,current_line:c,word:t,element:n},r&&(console.log("====================="),console.log("current_line: ",d.current_line),console.log("word: ",d.word),console.log("line_width: ",d.line_width),console.log("width: ",d.element.getBoundingClientRect().width),console.log("line_width >= width: ",d.line_width>=d.element.getBoundingClientRect().width),console.log("=====================")),o>=n.getBoundingClientRect().width&&(a.push(c),o=e(!1,t,n),c=""),c+=(""!=c?" ":"")+t,l==s.length-1&&a.push(c))})),a}(s,n,i,r);!function(e,t,n){const i=e.length-1,r=t-1;e.length>t&&(e[r]='<span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; width: '+parseInt(n)+'px; display: inline-block;">'+e[r],e[i]+="</span>")}(a,i,n.offsetWidth),t(n)||(n.dataset.thellipsisOriginalText=s),n.innerHTML=a.join(" ")}window.onresize=()=>{renderTruncate()},window.renderTruncate=()=>{let e=document.querySelectorAll(".truncate");Array.prototype.forEach.call(e,(e=>{n(e,3,!1)}))},window.dispatchEvent(new Event("resize"))},679:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(705),r=n.n(i)()((function(e){return e[1]}));r.push([e.id,".good-img{height:150px;background-position:center;background-repeat:no-repeat;background-size:contain}.card-title{height:76px}.item-count{width:64px;text-align:center}.cart-list .good-img{background-position:center top}",""]);const s=r},379:(e,t,n)=>{"use strict";var i,r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function a(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function o(e,t){for(var n={},i=[],r=0;r<e.length;r++){var o=e[r],c=t.base?o[0]+t.base:o[0],l=n[c]||0,d="".concat(c," ").concat(l);n[c]=l+1;var h=a(d),u={css:o[1],media:o[2],sourceMap:o[3]};-1!==h?(s[h].references++,s[h].updater(u)):s.push({identifier:d,updater:f(u,t),references:1}),i.push(d)}return i}function c(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var s=n.nc;s&&(i.nonce=s)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var a=r(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var l,d=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function h(e,t,n,i){var r=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=d(t,r);else{var s=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(s,a[t]):e.appendChild(s)}}function u(e,t,n){var i=n.css,r=n.media,s=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var m=null,p=0;function f(e,t){var n,i,r;if(t.singleton){var s=p++;n=m||(m=c(t)),i=h.bind(null,n,s,!1),r=h.bind(null,n,s,!0)}else n=c(t),i=u.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var n=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var r=a(n[i]);s[r].references--}for(var c=o(e,t),l=0;l<n.length;l++){var d=a(n[l]);0===s[d].references&&(s[d].updater(),s.splice(d,1))}n=c}}}}},t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={id:i,exports:{}};return e[i](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class t{constructor(t,n){e(this,"_text",""),e(this,"_callback",null),this._text=t,this._callback=n}onBtnClick(){const e=this._callback;"function"==typeof e&&e()}getTemplate(){const e=document.createElement("button");return e.classList.add("btn","btn-primary","w-100"),e}render(e){if(e){const t=this.getTemplate();t.innerHTML=this._text,e.appendChild(t),t.addEventListener("click",(()=>{this.onBtnClick()}))}}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class r{constructor({name:e,price:t,img:n},r){i(this,"_name",""),i(this,"_price",0),i(this,"_img",""),i(this,"_CartInstane",null),this._name=e,this._price=t,this._img=n,this._CartInstane=r}addToCart(){this._CartInstane.add(this)}render(e){const n=document.createElement("div");n.classList.add("col-md-12","col-lg-6","mb-4"),n.innerHTML=`\n            <div class="card h-100 shadow-sm">\n                <div class="card-body">\n                    <div class="good-img" style="background-image: url(${this._img});"></div>\n                    <h5 class="card-title truncate" title="${this._name}">${this._name}</h5>\n                    <p class="card-text text-primary fw-bold">${this._price} руб.</p>\n                </div>\n            </div>\n            `;let i=n.querySelector(".card-body");new t("Добавить в корзину",this.addToCart.bind(this)).render(i),e.appendChild(n)}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class o extends t{getTemplate(){const e=document.createElement("button");return e.classList.add("position-absolute","top-0","end-0","btn-close","mt-2","me-2"),e}}class c extends t{getTemplate(){const e=document.createElement("button");return e.classList.add("btn","btn-outline-secondary"),e}}class l{constructor({name:e,price:t,img:n},i){a(this,"_name",""),a(this,"_price",0),a(this,"counter",1),a(this,"_img",""),a(this,"_CartInstance",null),this._name=e,this._price=t,this._img=n,this._CartInstance=i}removeFromCart(){this._CartInstance.remove()}countMinus(){this._CartInstance.add(this,-1)}countPlus(){this._CartInstance.add(this)}render(e){const t=document.createElement("div");t.classList.add("card","position-relative","mb-4","shadow-sm"),t.innerHTML=`\n            <div class="card-body cart-items">\n                <div class="row">\n                    <div class="col-3"><div class="good-img h-100" style="background-image: url(${this._img});"></div></div>\n                    <div class="col-8">\n                        <div class="fw-bold truncate" title="${this._name}">${this._name}</div>\n                        <div class="text-primary fw-bold mt-2 mb-2">${this._price} руб.</div>\n                        <div class="input-group input-group-sm"></div>\n                    </div>\n                </div>\n            </div>\n        `,new o("",this.removeFromCart.bind(this)).render(t);const n=t.querySelector(".input-group");new c("➖",this.countMinus.bind(this)).render(n);const i=document.createElement("div");i.classList.add("input-group-text"),i.innerHTML=`${this.counter}`,n.appendChild(i),new c("➕",this.countPlus.bind(this)).render(n),e.appendChild(t)}}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class h{constructor({placeholder:e,type:t,text:n,id:i}){d(this,"_placeholder",""),d(this,"_type",""),d(this,"_text",""),d(this,"_id",""),this._placeholder=e,this._type=t,this._text=n,this._id=i}validate(){const e=document.getElementById(this._id);e.addEventListener("change",(()=>{const t=e.value;let n=/./;n="name"===this._type?/^[A-ZА-Я]{1,32}$/i:"tel"===this._type?/^\+?(\d{1,3})?[- .]?\(?(?:\d{2,3})\)?[- .]?\d\d\d[- .]?\d\d\d\d$/:"email"===this._type&&/^[A-Z0-9._%+-]+@[A-Z0-9-]+.+.[A-Z]{2,4}$/i,n&&(t.match(n)?(e.classList.remove("is-invalid"),e.classList.add("is-valid"),console.log("корректно заполнено поле: "+this._text)):(e.classList.remove("is-valid"),e.classList.add("is-invalid"),console.warn("некорректно заполнено поле: "+this._text)))}))}render(){const e=document.querySelector(".modal-body");if(e){const t=document.createElement("form");t.classList.add("needs-validation"),t.innerHTML=`\n            <div class="form-floating mb-3">\n                <input type="${this._type}" class="form-control" id="${this._id}" placeholder="${this._placeholder}">\n                <label for="${this._id}">${this._text}</label>\n            </div>\n        `,e.appendChild(t)}}}n(830);var u=n(379),m=n.n(u),p=n(679);m()(p.Z,{insert:"head",singleton:!1}),p.Z.locals;const f=new class{constructor(){var e,t;t=[],(e="_items")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t}add(e,t=1){const n=this._items.find((t=>t._name===e._name));n?n.counter+=t:this._items.push(new l({name:e._name,price:e._price,img:e._img},this)),this.render()}remove(){const e=this._items.findIndex((e=>e._name==this._items._name));this._items.splice(e,1),0==this._items.length?this.resetCart():this.render()}render(){const e=document.querySelector(".cart-list");e&&(e.innerHTML=""),this._items.forEach((t=>{t.render(e)})),new t("Сбросить корзину",this.resetCart.bind(this)).render(e);let n=0;for(let e=0;e<this._items.length;e++)n+=this._items[e]._price*this._items[e].counter;const i=document.createElement("div");i.innerHTML=`\n        <div class="card bg-success text-white mb-4 mt-4 shadow-sm">\n            <div class="card-header">Общая сумма заказа</div>\n            <div class="card-body fs-3">${n} руб.</div>\n        </div>\n        `,e.appendChild(i),renderTruncate()}resetCart(){this._items=[],this.render(),document.querySelector(".cart-list").innerHTML="Эй майнер, твоя корзина пуста 😪"}};new class{constructor(e){s(this,"_items",[]),s(this,"_page",1),s(this,"_CartInstane",null),this._CartInstane=e,this.initShowMoreButton(),this.fetchGoods()}initShowMoreButton(){const e=document.querySelector("#showmore");e&&e.addEventListener("click",(()=>{this._page++,this.fetchGoods()}))}fetchGoods(){const e=`./api/items${this._page}.json`;return fetch(e).then((e=>e.json())).then((e=>{const t=e.data.map((e=>new r(e,this._CartInstane)));return this._items=[...this._items,...t],this._items})).then(this.render.bind(this)).catch((e=>{alert("Больше страниц нет"),document.querySelector("#showmore").classList.add("invisible")}))}render(){const e=document.querySelector(".goods-list");e&&(e.innerHTML="",this._items.forEach((t=>{t.render(e)}))),renderTruncate()}}(f),new class{fetchInputs(){return[{placeholder:"Имя содержит только буквы",type:"name",text:"имя",id:"floatingName"},{placeholder:"Телефон в формате +7(000)000-0000",type:"tel",text:"телефон",id:"floatingPhone"},{placeholder:"name@example.com",type:"email",text:"email",id:"floatingEmail"},{placeholder:"без проверки",type:"text",text:"пишите что хотите",id:"floatingOthers"}]}constructor(){var e,t;t=[],(e="_inputs")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t;let n=this.fetchInputs();n=n.map((e=>new h(e))),this._inputs=n,this.render()}render(){this._inputs.forEach((e=>{e.render(),e.validate()}))}}})()})();